<!DOCTYPE html>
<html>
<head>
  <title>人臉註冊系統</title>
  <style>
    /* 顏色可改 */
    :root{
      --brand:#3b82f6; --accent:#8b5cf6; --teal:#06b6d4;
      --bg-deep:#0b1220; --bg-deeper:#0a0f1a; --border:#1f2937;
    }

    /* 全站背景 */
    body.theme-tech{
      color:#e5e7eb;
      background: 
        radial-gradient(1000px 500px at 15% -10%, #1f2937 0, transparent 60%),
        radial-gradient(900px 400px at 85% -15%, #111827 0, transparent 60%),
        linear-gradient(#0a0f1a, #0b1220 60%, #0a0f1a);
    }

    /* 霓虹網格 */
    body.theme-tech::before{
      content:""; position:fixed; inset:0; z-index:-2; pointer-events:none;
      background:
        linear-gradient(#3b82f620 1px, transparent 1px) 0 0/ 48px 48px,
        linear-gradient(90deg,#3b82f620 1px, transparent 1px) 0 0/ 48px 48px;
      mask: radial-gradient(1200px 600px at 50% 40%, #000 60%, transparent 100%);
      opacity:.5;
    }

    /* 流動光暈 */
    body.theme-tech::after{
      content:""; position:fixed; inset:-20% -10% -10% -10%; z-index:-3; pointer-events:none;
      background:
        radial-gradient(260px 160px at var(--x,18%) var(--y,22%), color-mix(in srgb, var(--brand) 50%, transparent) 0, transparent 60%),
        radial-gradient(300px 180px at calc(100% - var(--x,18%)) calc(100% - var(--y,22%)), color-mix(in srgb, var(--accent) 45%, transparent) 0, transparent 60%),
        radial-gradient(200px 140px at 50% 80%, color-mix(in srgb, var(--teal) 35%, transparent) 0, transparent 65%);
      filter: blur(18px);
      animation: glowMove 14s ease-in-out infinite alternate;
      opacity:.9;
    }
    @keyframes glowMove{
      0%   { --x:18%; --y:24%; opacity:.7; }
      100% { --x:78%; --y:68%; opacity:.95; }
    }
    @media (prefers-reduced-motion: reduce){ body.theme-tech::after{ animation:none; } }

    body.theme-tech .panel{
      background:#0b1220cc;
      border:1px solid var(--border);
      color:#e5e7eb;
      backdrop-filter: blur(8px);
      border-radius:14px;
      box-shadow:0 12px 40px -20px #000;
      padding:20px;
    }

    body.theme-tech label{ color:#e5e7eb; }
    body.theme-tech input[type="text"]{
      background:#0f172a; color:#e5e7eb; border:1px solid #334155; border-radius:10px;
      height:44px; padding:0 12px; outline:none;
    }
    body.theme-tech input[type="text"]:focus{ border-color:#3b82f6; box-shadow:0 0 0 3px #3b82f633; }

    body.theme-tech video{
      width:100%; height:auto; aspect-ratio:4/3; object-fit:cover; border-radius:10px;
    }

    .titlebar{
      display:flex; align-items:center; justify-content: center;
      gap:12px; margin: 0 0 8px;
    }
    .titlebar .logo{
      height:36px; width:auto;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.4));
    }
    .titlebar h2{margin: 0;}

    header {
      display: flex;
      justify-content: flex-end;
      padding: 10px 24px;
    }

    main h2 {
      text-align: center;
    }

    main fieldset {
      text-align: center;
      border: none;
    }

    #loginBtn{
      padding: 8px 14px; border-radius: 12px;
      background:#0b1220cc; color:#e5e7eb; border:1px solid #334155;
      cursor: pointer; 
    }
    #loginBtn:hover{ background:#180467; }

    #registerBtn{
      display: block;
      margin: 24px auto 0;
      background:linear-gradient(90deg, #3b82f6, #8b5cf6);
      color:#fff; border:none; border-radius:10px;
      padding:10px 16px; cursor:pointer;
      font-weight:bold; font-size:16px;
    }
    #registerBtn:hover{
      background:linear-gradient(90deg, #2563eb, #7c3aed);
      box-shadow:0 4px 12px rgba(0,0,0,0.2);
    }

    #message{
      display: block;
      text-align: center;
      height: 80px;
    }

    .theme-tech video{ width:100%; height:auto; aspect-ratio:4/3; object-fit:cover; border-radius:10px; }

  </style>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body class="theme-tech">
  <header class="header">
      <button id="loginBtn" type="button" onclick="location.href='/login'">登錄</button>
  </header>


  <main class="panel" style="max-width:720px; margin:48px auto 24px;">
    <div class="titlebar">
      <img class="logo" src="https://i.ibb.co/PZVYTR1N/logo-12-1.png" alt="logo" />
      <h2>人臉註冊系統</h2>
    </div>

    <form id="registerForm">
      <fieldset>
        <label for="name">姓名：</label>
        <input type="text" id="name" name="name" required />

        <div class="video-wrap" style="margin:16px 0;">
          <video id="video" autoplay muted playsinline></video>
        </div>
      </fieldset>

      <button id="registerBtn" type="submit">註冊</button>
    </form>
  </main>

  <canvas id="canvas" width="320" height="240" style="display:none;"></canvas>
  <div id="message"></div>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');   
    const ctx = canvas.getContext('2d');

    // 啟用攝影機
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => alert('無法開啟攝影機：' + err));

    document.getElementById('registerForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      if (!name) return alert("請輸入姓名");

      // 拍照
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      const imageData = canvas.toDataURL('image/jpeg');

      // 傳送資料
      const res = await fetch(' https://322b23d6594f.ngrok-free.app/api/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, image: imageData })
      });

      const data = await res.json();
      const msgDiv = document.getElementById('message');
      msgDiv.textContent = data.message;
      msgDiv.style.color = data.status === 'success' ? 'green' : 'red';
    });
  </script>
</body>
</html>
